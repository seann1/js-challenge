From 91ca148de7f7add8681149031351e8aeedf99989 Mon Sep 17 00:00:00 2001
From: Sean Niesen <seanniesen@gmail.com>
Date: Thu, 26 Feb 2015 17:25:59 -0800
Subject: [PATCH 07/25] add dates to table

---
 app.js     | 14 +++++++++-----
 index.html |  2 ++
 2 files changed, 11 insertions(+), 5 deletions(-)

diff --git a/app.js b/app.js
index 637f670..90597d7 100644
--- a/app.js
+++ b/app.js
@@ -10,6 +10,7 @@ app.controller('MainCtrl', [
 			var startDate = $scope.startDate;
 			var startDateMilli = new Date($scope.startDate).getTime();
 			var endDateMilli = new Date($scope.endDate).getTime();
+			var dates = [];
 
 
 
@@ -20,29 +21,32 @@ app.controller('MainCtrl', [
 
    		//make api call inside of call to google maps api
    			var i = 0;
-   			var times = [];
 	   			while (startDateMilli <= endDateMilli) {
 
 	   				var currentDate = new Date(startDateMilli);
 	   				var splitDate = currentDate.toString().split(" ").slice(1, 4).join(" ");
+	   				dates.push(splitDate);
 	 					var sunriseurl = "http://api.sunrise-sunset.org/json?lat=" + results[0].geometry.location.lng() + "&lng=" + results[0].geometry.location.lat() + "&date=" + currentDate + "&callback=mycallback";
 			   		var response = $.ajax({
 											    		url: sunriseurl,
 											    		dataType: "JSONP",
 											    		success: function(data) {
-											    			$("#sunrises").append("<tr class='day day" + i + "'><td>" + splitDate + "</td><td>" + data.results.sunrise + "</td><td>" + data.results.sunset + "</td><td>" + data.results.day_length + "</td></tr>");
+											    			$("#sunrises").append("<tr class='day day" + i + "'><td class='date date" + i + "'>" + "</td><td>" + data.results.sunrise + "</td><td>" + data.results.sunset + "</td><td>" + data.results.day_length + "</td></tr>");
 											    			// $scope.sunrise = data.results.sunrise;
-											    			times.push("arf");
 										    			i += 1;
 											    			return data;
 											    		}
+														}).done(function() {
+															for (var i = 0; i <= dates.length; i++){
+																$(".date" + i).text(dates[i]);
+															}
 														}); //end of api call
 			   		console.log(response);
 						startDateMilli += 86400000;
-						console.log(times);
+						console.log(dates);
 			   	} //end of while loop
   			}
-			});
+			}); //endof geocoder
 
 			$scope.address = '';
 			$scope.city = '';
diff --git a/index.html b/index.html
index ef2b618..33f7575 100644
--- a/index.html
+++ b/index.html
@@ -23,6 +23,8 @@
       <tbody id="sunrises">
       </tbody>
       </table>
+      <div class="date">
+      </div>
 
       <form ng-submit="getTimes()">
         <label>Address</label>
-- 
2.1.3.36.g8e36a6d

